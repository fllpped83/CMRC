clc;
clear all;

% data='CCACATTTATAAGCACCACTGGCTACTAAAGCCGTCAGTGTATAACGCATGTCGGTCTTTATGGAGGGCAGTCTCCAATGAGCCGAGCCGACCTCTGGACCACAACCGGTAGAACTCACTCTCGTGTCTCCCTCGGCTCGGTCTTGGCGTCTGTGCCACCTGGGCTTACGCGAATCTACAGCATCACGGATATCGTGTCCCTTCACTCTATCCCTGCCAGATTCACCCTAGAGGAGATCAAAACTTTAGCTGAACTGAGCAATCGCAGTTCGAAAGGTAGTAATTGCTCATTTTTTAGTAATGTGCGTCCCACAGGGTTCACCCGATTCCCACGAGGGAGTAAGTTAAGGCCCACAACCTAACTGATTGGGCACAGGGTCATTCGATACTACATTGTCTTGGCACTCCCTCACCGATTACGAAATTCAAAGGACTAGGGCCTTCAGAATTTTGAAATAAACCCGCTGGAGTGTATCTGTGCAAACGTTAGTAATTTGCTCTTCCGAGCGTAAAGTAAATACCTGACACGACTGCAATATGAGGTCTTCTTACTAGTTACGGTTAAAGGTCGACTTCTGTTATATCTTTAGGGGCGACAGCTAGTCTCTGTTGGATTTTCTTAGAAAAGAGGACAAAATCATGTAGCAGCATATTTGAGAATAAGGCCACTGTAATTACTTGAGCATTCGATAGACGTAGTCACGGGGCTTAAACAATAGCCTGCGCTAACACGCCTGACTTGCGGAATCGATTCTATTGTCAATTTCCCGCTACTTTACGGGACCACTAAGCGCAGGTCCTCTGCTTTATGTCTATGATAATACAACGTAGGCAACTCCATTCGGCAGGTGAACTCGGTTATGGCTAGTTTGTTATTGATCAAAAAGTCAAATGTGATACCTGGCCTGCGACGGCAGTAGTCTCAAATGGGACGAGGGCTTCATTGAATAATCTACCATCTTTAGTCCCGTGGAGGTGCGAGTCCATTAAGCATTGCTGATAGACCAATAACGTCCCGTGCGAATCGCACCGATGAGCTACCCATAACCAAACGGCCTAAGATATCCGCCACCTTATTCACCTCCCTTACCCTCCCCGAACGGCTAAACGCTCTCAGGTTTAAGGAGAACGCCATTCTAATCACCCAGAGGGTCATTAACCGTTTACGCACACCGTGGCTTAAGTGATGCCCGAATCGGAAAATGCTGGTGCACCGGGTCCGTCTTAAGGATGAGCAACTCTGATGGATTTCTGATGTTATGCTCGAATAGATTTGCGCTGTTCCATATGTTAGAGGTCTAACGTATACACCTAGTAGACTGTGGCCACACGTTAGACCCGAGTCACTGGTATCTGCCAGCTGTCCCCCGGTCCTTAGAATCACCCAATATCGGGTGCACTCTTTCAACCCTCCATGTTATAAAAGATTCAACGACAAGTCATCCTTGATACTCAGGAAAATGGAGGGTCTCCGTAAATAGATTTATTTCTTGTACGATTATACCAGGTATAGACTCCCGAAACGTCAAACAAATTTCAAGGCACGTGATCCTCGCACACGTATTTCTTGATGGCCACACGCACCACGTAGAAATTCCCATCTCAACCAGGGGAGTCACCAGCATTTGAGGGAGGGCTTTGATTAATAGTTAAAGGAGAACCGAGTCGGTAGTCCCCTTTGAGCATCATCAAGCCATGCGGTCCCGGGTCGGAGCTCATCTATACCCTATGTGATCCCCAAGTTGGTCCCGGTAGAAGAAGGTAAACAGTTCAATCGCCCGTATTGTTGATACGATTTCCCGACCTTAACCCCTTGGCGCGAAGGCACACCCTATTGCTGAGCTGTCGCAATCATGATCATCCGCAACCAGTACCAGAGTGGCACTTTTGTGGCGCCTGGTCTCTGCGTTCGGGACTTATGTTGAAAATAGAACACGTTGACCAAAACATGGCGCACTAGTCGCACCGATGTCTGGCTTGATTAACTACCATGCTGCCAGAGCCTCGGCGACGGACTTACGGCCGATAACTGATGCGGTTGCTAAAAAACTTTCAACCACTAGCGAATGAACACTTTCGGGTCGCAATTGCGCAATGAGCACCCGGTGCGTCGCGGATCGTTCAGTATAAATGGAAATAGCAGAGGTGCCTATAGCCCATTAACACCCGGCAGTTCTGCCTCGCCACTGCGCACGGCAGGTTGTCGACACCGGAGTCTAAATTATCGCGCGGAATAGCGTGGAGGTTAACCGGTTATCAGGCCGGTCGTATTTGCCGATTGAGAAGCTTGCCGTCGAAAGCCTTCGGTGCTGACACGCCCCACATCAATATCCTCACGTCAATATGGTGTATGACGGAATATTAGGCTGACCATCGGCATATAGTTGCTTCGGAAGTTGAACGCGTGTGCTTATTTTCTTCTTAGCTTAAATACCCTCGAGTCGTTTATCCCAGACCAGGAGGGCCTGCGACGCGTCCCCTCAGGTGATAAGTTGAAGGCTAGAGTGGCCTATTGACCGAATTTACGCCCTTAAAGTGGCTATTGCTGTGCTACCGGTATAAAACTAGCCTCTTTATCATAACTCGGCCACGAGTTTCGCCTTAAGACAATGTGTAGAAATCAGAAGGCGTGGATTACCCGATAATAGTGAATGAGCCACAAGGCTCGTGTTTGCGTGAGCCAGGGCTACGCCTTTGAGAAGTTGCTCGTGGTATTACAGGATAAACGGTGAGCCTTTGTCCCAGCGTCTTTACTATGTTAGGTCAGAGTAAAGCAATGCGCACGTTGACCCATTAGGTCAGCCTTAATAGTCTCACTTCCAATTTGATGGGATGCGCGACTTACCTAACTATGCGAGGGTCGCGTGGCTCAACTGCTTTCTAAGATGACAAGCAACACATGACTCCCCACTGGGCCAAATTTGAGTAGCCCAGACAGGGTACACGACATCTCACCTGTATACGAAACCGTCAACACCTCATTCAGCTGTATCCCACAATTGGCCACCGCGCCAACTTTTCGTATCGCTGCTGTGAACATAAGCCGAAATGTGCGGCGGAAGGTTAGATGTTTCCCCAACCTTAAAAGGTTATTTATATGTTAGGCGAAAGCCAGTCGGACACTTCTCTCGGAATCGGTGATAAGAGAAGAGTTGAACCCCTGGCGCAACAGAATTCGACATCACAGGGGGCCTGGAGGTATAAGAAATTAATCATGAGTACAAAATAGGAACACCATGGATTGACTGCGACATCCGTGTCGGTGGTAATAGAACCTTGCGCCTCAACGATTAGAAATGTTAGCCGAGAACTACAAATGGCGCGCAACATGTCCAAGCAAAACATTAAGACCTACGCGTAGCTGATCTAGTTCGCGTGGGTGCTCAATCGTCAGACGATCCGACGACAGTAGGACGACCTGTTGAAAAAGTTTCTATGATGTTATGAGGGCACGGTACCGCTGCGTGGCAAATGGGCTTATAAACCCAGCTGGACGATATGGTACTCATGTCTAAGTGCTCCCACGGTAAACAGGACAACATGTTCGCGTTCGTCTTCAAACTTTCTGCAATAATTTATGTACCCTCCGGAGAACGGATATAAATGATGGTGTAGCCACCTCGCTCCCGACCCTGCCAGCAGTAAAGTCTGTAGTATGGCCTTTGCGGACCCGATGACCAAGCGGAACAACAGTCAATCTGTGCGCCAGCCTTTACAGGAAGTGCGGGCGTGATGATCGAGTTGGGTGATAAATCTGTCTCCACACAGTTGATACTGCGACATAACTGGATCGGCTGCCCATCTGAACATCTACCAAGCCCTGCGACACGTATCGGCTTATCGTCTCACTGAACCTTATATGTGCAAAAGTCTCATAACCCTGGATCAGTCAACATACGGATAGGGTGATACTAGTCTCAGCTCGTCGACATCAGACTGGACTATTTCCTAACCTGAAACGTCGAAATTGCGGCTTCACCGCCGAGCCAATCCCTAATAGGTTTAGGCTCGGCACTGTGCACAATTGCTAGGATCACCGTCCACCTACAAGTGTGACCGACAGTTTCACGGATCTCCCCGCGTGTAGCTGTCCTCAAAGACCATGCCTAGAAAATCAACAGCTGTTATGGCTCTACTACATCGGCACAAACGGCTGGGCAAATGCTACAAGAACATGCAGTAACTAACTCAACAAAAGAATTGGGCCGGAGCCCGAATGTCGGAAGATGATACAAGTGTTCCAATAGTAACATCTTGGAGTTTACTACACGCTAACATAAGTGGATTAGAGCGCGTAAGCATTGCGACATAAGTTTTATAGCCCAGCGAGGGCTCTTTTGTTCTCCCTGTGTTTCTGGCAACAGCCACCCACATGATTCAGACATACTCAAGTGGCTACGGCTCCACATAGAGGCACAATTCTGAGACGCAACTCCGGTTGCGCGTACTCATTCAAGAATTTGCCGTCTATTTATAAGCTCCTCAAATTCACCAACGATAACGTCGGCACGACCAGAAGTAGCAGATCATCTGTCACGCCAATCTCCCATAAGTGCTCATTGCTCAAACATTAGTGCCGGAGCAGGCTCAAAACCGGGATCACACGCCCGGTAATTATAAGCCACTCCTTTCGTTCGCCGTGGCGTTCAACATCTGTGGCGACGGGTAAAGTACGGGCGACTCCATTTATCATCCTCGCAAAGGGCCTGTCTTGGCCATAATGTAGCGATGGGCTTCACCATCGGTTGCTGGGATAAGCGTGGCCATCTAGATCACGTGCGAAGTTGATTAACACCGAAATGCGGTAGCAATTCAGCCCAGAGTCAGCGGTATCGTCACGCCGATTCCAGTTTCGTCTGGCTCCATGGCGGGCTTTTGTGACACGCCCCAAGCACCAGCAGTGCCAATCCGGAAGTAGACAACAGTTCCAGAAGCCGGTGGAGTCCTTTTTATAATACTCGTGCCTCTACATATTCCAGCAGTTGCGCTGTAGTAGACCTAGGACAGATTTTGAAAAGCGGTTGGAATAAATGTTCAGTCTATAGGCTGCTCGTCTTCCGGTTATATGTTCTGTGCCCGATAGTATCGCCCACTTTATCTTGCACCAGACCATTCTCGAACCGGTCGACGACCAGATGCGCGCCGATGAGTTTAGATGTTCTCTACTAAGCGAAAAGGTGATCATGGGCTCCCAGCCCAGTCGCGGGAATGGCAGAGTGGCGTTTGGCCCTTCTTTGCTTACCCGAGCCGCTCGACGGCTTAAGTTTGAGCGGAGGGTCTGGACCAAATACCGCTGCACGTTCCGCCTCTAAACCGGGATCACACGCCCGTTAATTATACGATTGCCGGTGAACGGGAGAGATGCTTTTCTATTTAAGGGTCTAGTTTAGCGGCTGATTTTCTTATAGCTTTATGTGATCCCCAGTATTCAGTGTAAAACCGGTCGCCGATTTCCCTTGACAGTTAGTCTCAAGTTAAGGCTAAATTCTCGCCTGCCCAGAAGGAGCAGAGAATAGTTCAAGGGGTGCGCTGCGTGAATGATTTAGCAGTGGGACCGATCAGAAAATGACCCCGTAGATTAGTGGCTCAAACGGCTCTCCAACTGGTATCCCCTAAAGCCATGCCCAGTTAGACCCACGGATTTAGGGCGTGCGTCACGCGTGAATGGGAGAGTGCCAGGACGGGTTCCAGCTCTAAGAAGACTGGCAAGCGAGCCAATAGGACATGGGATTACCCCTGGGCTCTCTTACCGCATATGCAAACAGGGTCTGACGGGTCGCGTTTTAGAGTAAGATGATGGGATCGGCTAAACTCGCGTTTCGTTTCTATTATGACCCGAGTGAATTGCGCAGCCACGTCGGTAGACATTTAGGTCGACCGCTTATATCACCCCGCCCATTAGCAAAAGCCTAGTTAAAGCGTTCATTCGACCAGCTAACCGGTGACAAGATGTTAAACAGCCAGTAAACTATTGTAGTGCTTCTAGGGGACAATAGATGGCGACGTGCTGCCCTTCTATAGCCTAGGGGATCGTTTAGTGGCGAGAGTACTATTGTCCCACTCATATCCACCAAGCGTGTCTACGCGTATCAGATAGATACCACACATTAGGCTCACGCTAAAGCCGGCTCAATCAACGACAGTCTTTTATAAAACTAACCGCTCACGCGTGTATCTTTCCGCCCAGATTCTTGGAGACTGTTCCAATACGGAGACAAGAGGGTCTGGCCCTTGTGGATTATTTGCTGGCAAATCGGTGAACTCTCGGGAAACAATTAAACTCATGTGTCGGGTCGGAGACCATTGGCGTAAGAAAATCGACACGGCGTCCGGTATGAAAATATAAGCACTGGTGTACCCTAGAGGCGGTGCACAGTTTAGGGACGTGTATCACCTGTGCGCACCTGCGCACATCGATGTGCTCAGATTTCAAGTTATGGCAACCTGTTGTAGTTGCAGCATTGATCATCAACTCCGTTTGGATATACAAAGGCGCGTCGTTGACCTATTGGTCTTCCTCTGTGGGATAGCACTGACAAGGTGAACCCGGTGAAACGTTCGTGTACGCGGTCCACTCACTAAGGATCCGAGTAACGATCCAAAGCTTCGTAGAAGCGAGCCTGTAACAGGGTCTAACGTATCGGGATTCTTTTTGCAAAGGTATAAACCTAAATTTCCGGCTAATATCTGATTGTAGCAAATATAAATGCCACACATGCTGGTCTAAAACATTTCGCCCCATAAGGTCTACTAGGTCTAGTTGTGTCGAGGGCCGTCTGGCTGATAGAGTTCCCACATTATTAATCCAGCACATCGTAGGGTCTCAATGCAAAACTTATCAAGGTTGAGACACGCCTGTTTCTCTGTATGCTGGGACCTCTAGACACAATCTGAGTGCCTGGCAACAATCTCTTAGTACGGGGACATGACGCTTTGAACCCTGTGAGCCGGATAGAGTCGAACTCGGAGGCCTCTTAAAGTATCAAACGGGACAGGCGGTAATTAGGGAGTAGCTACCGTACTCCGGCAAACGACCTTCCTAGTGCTGTGACGCGTAGTGTATGGGAAATCCGTGGGCGCTCGGCTAGCGTAAAAAGTGTCGTAGAGACGATTTCTTCGTGGAGCCCAACACGCGGCTCCCGTCTCGCACCCAATAGAGAGCACCTTTTCGCCATTTCCCCTCTGTGCGGCAACATAAGGACGCCTGACATCAGTTTAGGGGAATCCCCTCTGATCACCCATTTGATCAAATCGGCGAGTACGATAGACTCGATTGGCGCGTGTCCCTTTTAGTGGAACGGGTCGAAGTGCTGCAGTTGAGTGTACATAGGGATTGCGTGATACGCACATAATAGGTAGGCGCAAAATTTGACAAAGCTAAATGCAGGCGCGATCACTGGGCTGAAACTGTTTCGTCCCGCATAATAGCAGAGCTTATCTCCTGCATTAGCGCAACCGGCGAAGGACAACAATCGGGCTGCTCGGGATTAGGTACCCCCGTTCAACCCTATCAAACGGTTGAGGACTCGCTGCGGTCAGACGTTTCGCCTTGGCTGCCCCGCGTCTCGTGCGGATGAAAATCATGAGGGCATTGGCTTAACCACCAAGTTCTCACCCTTCGGTTTCCGGTTATCGGTAAAGCTCTTCTCAACACGTTTCTGTATGGTCTTAGGACTTGGCAGGTGAGTGTGACCCATGGGCTACACCTGTGTCTCCAGCCTTTGCTAAGCTGTGACAAATGGCTCAAACTCTCCTCGCTCTTAAGCCGCTCGAGGACAGCAATCTATGACTCGTGCTACCATGATCGACATGCATAATTACGAGGGAGAACCAGCTGACAATACATCGAAATAGGAGTGTCCATTGGACAATGAATGCAAACTGTACACACAGCAGTAACGTATGGTCAAGCGTTGTGCGCTGTTATAATCCTACAGGACAAGGTCTCGGCAGTGGCGGTTCGGCACCAGGGGAGCGTATAATCTGTGCGTTAGCACAGGGTTACCCTAGGGGAGCCGACATTAATCCTACGCGCACTAATCTCGGAGCCGGAGGGGCGGACCAACAGCATGGATAAGGGGGTCGAGTCACCGATTTGCGCACAGCTATTCACCACTCTAACATTTCTCCACTAATTAGTGCCAGAACGCTTTCCGCAGCCGTGGGTTTAGCCGTGGAGGTTATTTCGCACCCGTATTGGTCAACCTCACCGCTGTCGCCAGGCTAGAGAGGAACTGCGAGAATAATAACGGGCTGTTCTCACTCGTGGCGAACCGGTTCTGCGGCCGGTGACCTAACGTGATA';
data='CCACATTTATAAGCACCACTGGCTACTAAA';
data_L = length(data);
num = 1;
i=1;
%记录碱基
seq='';
%记录游程
seq_num='';
%RLE编码
while i<=data_L-1
    if strcmp(data(i),data(i+1))
        num = num+1;
    else
        seq_num = strcat(seq_num,num2str(num));
        seq = strcat(seq,data(i));
        num = 1;
    end
    i=i+1;
    
end
if ~strcmp(data(data_L-1),data(data_L))
    seq_num = strcat(seq_num,'1');
    seq = strcat(seq,data(data_L));
else
    seq_num = strcat(seq_num,num2str(num));
    seq = strcat(seq,data(data_L));
end



%多规则混合编码
%seq处理  基准转换-交叉编码-轮转
%基准转换
seq_L = length(seq);
seq_base_num = '';
for i=1:seq_L
    if seq(i) == 'A'
        seq_base_num = strcat(seq_base_num,'00');
    elseif seq(i) == 'T'
        seq_base_num = strcat(seq_base_num,'01');
    elseif seq(i) == 'C'
        seq_base_num = strcat(seq_base_num,'10');
    elseif seq(i) == 'G'
        seq_base_num = strcat(seq_base_num,'11');
    end
end
%交叉编码
% a  0:CG  1:AT
%b    0      1
% A   GT    CA
% T   GA    CT
% C   CT    GA
% G   CA    GT
seq_JX = 'A';
% seq_JX(end)
seq_base_num_L = length(seq_base_num);
for ii=1:2:seq_base_num_L-1
%     seq_JX(end)
    if seq_JX(end) == 'A'
        if seq_base_num(ii) == '0'  &&  seq_base_num(ii+1) == '0'
            seq_JX = strcat(seq_JX,'G');
        elseif seq_base_num(ii) == '0'  &&  seq_base_num(ii+1) == '1'
            seq_JX = strcat(seq_JX,'C');
        elseif seq_base_num(ii) == '1'  &&  seq_base_num(ii+1) == '0'
            seq_JX = strcat(seq_JX,'T');
        elseif seq_base_num(ii) == '1'  &&  seq_base_num(ii+1) == '1'
            seq_JX = strcat(seq_JX,'A');
        end
    elseif seq_JX(end) == 'T'
        if seq_base_num(ii) == '0'  &&  seq_base_num(ii+1) == '0'
            seq_JX = strcat(seq_JX,'G');
        elseif seq_base_num(ii) == '0'  &&  seq_base_num(ii+1) == '1'
            seq_JX = strcat(seq_JX,'C');
        elseif seq_base_num(ii) == '1'  &&  seq_base_num(ii+1) == '0'
            seq_JX = strcat(seq_JX,'A');
        elseif seq_base_num(ii) == '1'  &&  seq_base_num(ii+1) == '1'
            seq_JX = strcat(seq_JX,'T');
        end
    elseif seq_JX(end) == 'C'
        if seq_base_num(ii) == '0'  &&  seq_base_num(ii+1) == '0'
            seq_JX = strcat(seq_JX,'C');
        elseif seq_base_num(ii) == '0'  &&  seq_base_num(ii+1) == '1'
            seq_JX = strcat(seq_JX,'G');
        elseif seq_base_num(ii) == '1'  &&  seq_base_num(ii+1) == '0'
            seq_JX = strcat(seq_JX,'T');
        elseif seq_base_num(ii) == '1'  &&  seq_base_num(ii+1) == '1'
            seq_JX = strcat(seq_JX,'A');
        end
    elseif seq_JX(end) == 'G'
        if seq_base_num(ii) == '0'  &&  seq_base_num(ii+1) == '0'
            seq_JX = strcat(seq_JX,'C');
        elseif seq_base_num(ii) == '0'  &&  seq_base_num(ii+1) == '1'
            seq_JX = strcat(seq_JX,'G');
        elseif seq_base_num(ii) == '1'  &&  seq_base_num(ii+1) == '0'
            seq_JX = strcat(seq_JX,'A');
        elseif seq_base_num(ii) == '1'  &&  seq_base_num(ii+1) == '1'
            seq_JX = strcat(seq_JX,'T');
        end
    end
end
%转二进制流
seq_JX_L = length(seq_JX);
seq_JX_2 = '';
for seq_JX_L_I = 1: seq_JX_L
    if seq_JX(seq_JX_L_I) == 'A'
        seq_JX_2 = strcat(seq_JX_2,'00');
    elseif seq_JX(seq_JX_L_I) == 'T'
        seq_JX_2 = strcat(seq_JX_2,'01');
    elseif seq_JX(seq_JX_L_I) == 'C'
        seq_JX_2 = strcat(seq_JX_2,'10');
    elseif seq_JX(seq_JX_L_I) == 'G'
        seq_JX_2 = strcat(seq_JX_2,'11');
    end   
end

%交叉编码解码
seq_JX_2_L = length(seq_JX_2);
de_seq_JX_2 = '';
for seq_JX_2_L_I = 1: 2 : seq_JX_2_L
    if seq_JX_2(seq_JX_2_L_I) == '0'  &&  seq_JX_2(seq_JX_2_L_I + 1) == '0'
        de_seq_JX_2 = strcat(de_seq_JX_2,'A');
    elseif seq_JX_2(seq_JX_2_L_I) == '0'  &&  seq_JX_2(seq_JX_2_L_I + 1) == '1'
        de_seq_JX_2 = strcat(de_seq_JX_2,'T');
    elseif seq_JX_2(seq_JX_2_L_I) == '1'  &&  seq_JX_2(seq_JX_2_L_I + 1) == '0'
        de_seq_JX_2 = strcat(de_seq_JX_2,'C');
    elseif seq_JX_2(seq_JX_2_L_I) == '1'  &&  seq_JX_2(seq_JX_2_L_I + 1) == '1'
        de_seq_JX_2 = strcat(de_seq_JX_2,'G');
        
    end   
end

% strcmp(de_seq_JX_2,seq_JX)
de_seq_JX_2_L = length(de_seq_JX_2);
de_seq_base_num = '';
for seq_JX_2_L_II = 1 : de_seq_JX_2_L-1
    if de_seq_JX_2(seq_JX_2_L_II) == 'A'  &&  de_seq_JX_2(seq_JX_2_L_II + 1) == 'A'
        de_seq_base_num = strcat(de_seq_base_num,'11');
        continue;
    elseif de_seq_JX_2(seq_JX_2_L_II) == 'A'  &&  de_seq_JX_2(seq_JX_2_L_II + 1) == 'G'
        de_seq_base_num = strcat(de_seq_base_num,'00');
        continue;
    elseif de_seq_JX_2(seq_JX_2_L_II) == 'A'  &&  de_seq_JX_2(seq_JX_2_L_II + 1) == 'C'
        de_seq_base_num = strcat(de_seq_base_num,'01');
        continue;
    elseif de_seq_JX_2(seq_JX_2_L_II) == 'A'  &&  de_seq_JX_2(seq_JX_2_L_II + 1) == 'T'
        de_seq_base_num = strcat(de_seq_base_num,'10');
        continue;
    elseif de_seq_JX_2(seq_JX_2_L_II) == 'G'  &&  de_seq_JX_2(seq_JX_2_L_II + 1) == 'A'
        de_seq_base_num = strcat(de_seq_base_num,'10');
        continue;
    elseif de_seq_JX_2(seq_JX_2_L_II) == 'G'  &&  de_seq_JX_2(seq_JX_2_L_II + 1) == 'G'
        de_seq_base_num = strcat(de_seq_base_num,'01');
        continue;
    elseif de_seq_JX_2(seq_JX_2_L_II) == 'G'  &&  de_seq_JX_2(seq_JX_2_L_II + 1) == 'C'
        de_seq_base_num = strcat(de_seq_base_num,'00');
        continue;
    elseif de_seq_JX_2(seq_JX_2_L_II) == 'G'  &&  de_seq_JX_2(seq_JX_2_L_II + 1) == 'T'
        de_seq_base_num = strcat(de_seq_base_num,'11');
        continue;
    elseif de_seq_JX_2(seq_JX_2_L_II) == 'C'  &&  de_seq_JX_2(seq_JX_2_L_II + 1) == 'A'
        de_seq_base_num = strcat(de_seq_base_num,'11');
        continue;
    elseif de_seq_JX_2(seq_JX_2_L_II) == 'C'  &&  de_seq_JX_2(seq_JX_2_L_II + 1) == 'G'
        de_seq_base_num = strcat(de_seq_base_num,'01');
        continue;
    elseif de_seq_JX_2(seq_JX_2_L_II) == 'C'  &&  de_seq_JX_2(seq_JX_2_L_II + 1) == 'C'
        de_seq_base_num = strcat(de_seq_base_num,'00');
        continue;
    elseif de_seq_JX_2(seq_JX_2_L_II) == 'C'  &&  de_seq_JX_2(seq_JX_2_L_II + 1) == 'T'
        de_seq_base_num = strcat(de_seq_base_num,'10');
        continue;
    elseif de_seq_JX_2(seq_JX_2_L_II) == 'T'  &&  de_seq_JX_2(seq_JX_2_L_II + 1) == 'A'
        de_seq_base_num = strcat(de_seq_base_num,'10');
        continue;
    elseif de_seq_JX_2(seq_JX_2_L_II) == 'T'  &&  de_seq_JX_2(seq_JX_2_L_II + 1) == 'G'
        de_seq_base_num = strcat(de_seq_base_num,'00');
        continue;
    elseif de_seq_JX_2(seq_JX_2_L_II) == 'T'  &&  de_seq_JX_2(seq_JX_2_L_II + 1) == 'C'
        de_seq_base_num = strcat(de_seq_base_num,'01');
        continue;
    elseif de_seq_JX_2(seq_JX_2_L_II) == 'T'  &&  de_seq_JX_2(seq_JX_2_L_II + 1) == 'T'
        de_seq_base_num = strcat(de_seq_base_num,'11');
        continue;
    end   
end

% strcmp(de_seq_base_num, seq_base_num)

de_seq = '';
de_seq_base_num_L = length(de_seq_base_num);
for de_seq_base_num_I = 1:2:de_seq_base_num_L-1
    if de_seq_base_num(de_seq_base_num_I) == '0' && de_seq_base_num(de_seq_base_num_I + 1) == '0'
        de_seq = strcat(de_seq, 'A');
    elseif de_seq_base_num(de_seq_base_num_I) == '0' && de_seq_base_num(de_seq_base_num_I + 1) == '1'
        de_seq = strcat(de_seq, 'T');
    elseif de_seq_base_num(de_seq_base_num_I) == '1' && de_seq_base_num(de_seq_base_num_I + 1) == '0'
        de_seq = strcat(de_seq, 'C');
    elseif de_seq_base_num(de_seq_base_num_I) == '1' && de_seq_base_num(de_seq_base_num_I + 1) == '1'
        de_seq = strcat(de_seq, 'G');
    end
end

% strcmp(seq,de_seq)


% %转四进制流
% seq_JX_L = length(seq_JX);
% seq_JX_2 = '';
% for seq_JX_L_I = 1: seq_JX_L
%     if seq_JX(seq_JX_L_I) == 'A'
%         seq_JX_2 = strcat(seq_JX_2,'0');
%     elseif seq_JX(seq_JX_L_I) == 'T'
%         seq_JX_2 = strcat(seq_JX_2,'1');
%     elseif seq_JX(seq_JX_L_I) == 'C'
%         seq_JX_2 = strcat(seq_JX_2,'2');
%     elseif seq_JX(seq_JX_L_I) == 'G'
%         seq_JX_2 = strcat(seq_JX_2,'3');
%     end   
% end

[goldman_sequence_JX, goldman_sequence_number_JX] = goldman(seq_JX_2)

% %seq_num处理  转成二进制--改进型RLE--ASCii--轮转
% seq_num_L = length(seq_num);
% seq_num_re = '';
% for seq_num_ii = 1:seq_num_L
%     if seq_num(seq_num_ii) == '1'
%         seq_num_re = strcat(seq_num_re,'001');
%     elseif seq_num(seq_num_ii) == '2'
%         seq_num_re = strcat(seq_num_re,'010');
%     elseif seq_num(seq_num_ii) == '3'
%         seq_num_re = strcat(seq_num_re,'011');
%     elseif seq_num(seq_num_ii) == '4'
%         seq_num_re = strcat(seq_num_re,'100');
%     elseif seq_num(seq_num_ii) == '5'
%         seq_num_re = strcat(seq_num_re,'101');
%     elseif seq_num(seq_num_ii) == '6'
%         seq_num_re = strcat(seq_num_re,'110');
%     else
%         fprintf("超限！")
%     end
% end
% 
% num = 1;
% seq_num_re_L_i = 1;
% %改进RLE的数据位
% seq_num_RLE_1 = '';
% %改进RLE的游程位
% seq_num_RLE_2 = '';
% seq_num_re_L = length(seq_num_re);
% while seq_num_re_L_i <= seq_num_re_L-1
%     if seq_num_re(seq_num_re_L_i) == seq_num_re(seq_num_re_L_i+1)
%         num = num+1;
%     else
%         seq_num_RLE_1 = strcat(seq_num_RLE_1,seq_num_re(seq_num_re_L_i));
%         seq_num_RLE_2 = strcat(seq_num_RLE_2,num2str(num));
%         num = 1;
%         seq_num_re_L_i = seq_num_re_L_i+1;
%     end
%     seq_num_re_L_i = seq_num_re_L_i+1;
% end
% %RLE_1   ASCII--轮转
% [goldman_sequence_RLE_1, goldman_sequence_number_RLE_1] = goldman(seq_num_RLE_1)

%seq_num处理  br压缩
% seq_num_Gzip = '1F8B08000000000000037D580B96E438083B93856BEE7FB49DD8202492D9BCEE4A2A060CE2EBC25A2BD6C2EAFFE7C5BD9F0BF2702823BF6235D3BD3D0F80F2E4D53B40C4811B397D7F0B3EB68468929DBA608DDBE5CBBDFE88C848A18FB8A81778B48E437FF964C594BA02A34DFE2BEA6E15D7EC47A1188CA27C8856CFCB18840403F288688CCA3D7B8DEBAFD0FDACEE959F73FF6B64D17EC2BE1E46846CB4A01FE6F0BF84D166340BA8A39B052EA26E8434514DD69F70836889AAB1A2184A587A6325A470F6E64D0F6BD448B01DB019055776EAFA38FA200C310D813204A6C181BA6D1033AED2BB614DECA6999D6582A167DEC859C7486962ACE7ED07821F2AFDD1911EDD84132A761D2350A990FE08DDA1BDD00E8BB0FCEFAB50F0A540D4A6DB40882BF23A3760D6AE2DA147DD63A61A89F6812152E532A9706B2B8E0460434ACB143AEA0514B855C929C0A0CBDA2ECA8A8F6FC1A0DC91A172B7983F5FFEAC3070AF75528D08B8EDD7311BCEBB525E68084A96A92BE1923BD071AEFB8E42290AAC0A50283A0E34565AEDE61C3499CAAA64A6F3B18EE110EDF718FBA658B87157F6ED2BF14202A533EB86047A94E98C31F2A093AB77D6D691EF53A6856A83182C32C5C2AA225BAAD3598501B502B104A365484AA11A490185625F844C0F6D120203E3CAC1BC70A1109C4D4E61ABF8BA7C3BF3962B8D4C6FCB46D4F17C4A9C79EC5CBF321FD9F6DB42ED07C32C32C18D0BB7D427A287768B6E5F78D908B4E697AE0BBFD108648CB9EFB28047A888B72135032A5EF55145A52A4668468A5C99123A5C6C64808C9AB8A1AFC0A4EEB1CA351E4A3DC1098B2328A0FB1089296B60DB2EAF08440CB85AE8FF5C57ED5B4D12ADC28A311E69A5278216EDA65605583A2C49186D2BCBD2579E527DB0471806C46D9FD1547249490A26AE58537E2589DA9799DD1562AFE28F36768C476A8605B5A52ECC7D6917BD27470C4C8C3F50A20C2C8D62C6BA8072E066132DA777F741FF0D2912C7D0388D3AE19856DD405527BCD4E614214DA658747F414DB224F9185ADBBCD7E70C6A5263F4C2CFF35700FC477A3EDE3F0510508CED092640022D3A1150566B04BCA4792945D9D6B2AA7B69AF0D04581485B90A0947CA709B0FDE12148A5BFB26316852496D37B80F158FDA15C961E0A673A2A2B286E822419E4DE4151B76895E730A93FCBF75258A91B750B7AC4665A557424C979B9F0EFBB44F18E76023C7042215468A26F6331799460D297336B395497685489DA80D3C10A4D44A8C47EFCE7AE7A549FBF53B878D72A2A2334601B33F2A4130384B9B9E4753015457BA84D2F8EF71CEF30D2DAD273456A41EA3C50F3A8B8E2EE10F43F555AD12ADB0D2DF142AB7DADB9A28A8432D22ED1DA506BACE3D3AA1FB13E6C847C75F6EFE401D14409A58AFDD0E4CE10EF3F009B57731F0FCA8D4F35686AE35E830C25725BC56DBD17F2B7D25AF33A633AA50D5A944472AE675B84AE38A68258BE637698838D1D116CB1D4FF6450723C311226ACB81A2DBEE877A54F9488457FD351C30F9C1ECD975A28AC115E37FCA168FA0C2587F96CABCF82D700AF621A1B32DF19F157FCBFA21A9B87ADA5E5485A06E9DC9691C9512935E9D15061B3B4667B1B65847687DBEE85F643028244D793EFB98CFB98F854659C4B2410F20EBCF36FE7EB8B5B54ABFE7A608DC4BAAEF3A2312BF586D120DABD04216BAA75789AEB4AB4392FF2E64458DAF3EC2D97FA569BEFF00CB78C5873A180000';
% seq_num_Gzip = '1B391880045536A9D31DDEB8FC7C91C166D96CA00506DB7CA741D7C106974160701B3E8274790BC14A0A23BFC00440003132A0204448540800304214403281004000D6865E83C01948565950E023C0B0180D8654A344C3006269785816ACD0990DE1EB98843102A78845C5BD070FA89713476A0F9906E5EC47DE384D0808822808A10D8C098104068010249288500493E0618014100033984882308C04482100250C0402306A4A202991654E6200AD88441886CA009102263A089A50010132204030A0400801048002610001012F455830C034218E048102E86488C14C40480033984D0104800905085803E540306646A14581E00640826C040003B8948594216148808DEA0A0A46002000A220108E4800192187203A040002240A014104118500856F0A10610605010B2008980688C0140B2104200A5060010A4855410526422498120007428010409120048894042027A1318031240B80439014A08834AC110250388881506054083028244320880206C840430222C4048D01031260041093A002500D03900430200423200270581B30300020808508011855423900404806520576D59581C40441A0084248278402E025212B008E2212000249A810214684600281E2280200203010000440107906100C112033B1418000101819110441669006A6483008243046C000502303450904100D0503000D060808004408030165002001400570802640200C00000020588A814522A14C3421000A824808080CC101408C108E800800C2C40C480011726AC50405102A088A0110220108017230309C188C840C08001144805000A20240D2044688454110880000A0300204232808D7009622A111110910CC602003C116540460221446500000892243501880008862202273001702940A08454AE8114000050200113847951180005481C000184308092A4000020602840B30C6802520D632320448196448238012D600A602526400873530042730C041C015620B04A462418C02847400080326E0702084098A70268C30320300644062052448A008266720018C010307028618308660A08040C0041170269CD01021A8206808438070040260017130048018400A0000804002984204701C0500588614502188A1453264446053036084147280507008048304980110400000C02452040101220B588088A2C00050B41801488022081A8140882160F25858B6224060180108C7380A1008B020000D290160104EA80062009800049024081C8069400108291A982129030894A10200006C6220C003004C880562000B40477680844200E672003318010050801DCA10800030010022C20DC3200086611804200802154562C0249E3498220001468503403860944A0996562183100C884411803110201A0298300828018100000200148C020418811411060010881040248882202572800002967104250082282705440F20068008C408051116C446A40C86A21020010A906408405441850C';
seq_num_Gzip = '1B391880045536A9D31DDEB8FC7C91C166D9';
seq_num_Gzip_L = length(seq_num_Gzip);
seq_num_Gzip_2 = '';
for seq_num_Gzip_i = 1:seq_num_Gzip_L
    seq_num_Gzip_2 = strcat(seq_num_Gzip_2,dec2bin(hex2dec(seq_num_Gzip(seq_num_Gzip_i))));
end
[goldman_sequence_RLE_2, goldman_sequence_number_RLE_2] = goldman(seq_num_Gzip_2)




% %RLE_2   碱基--轮转
% seq_num_RLE_2_L = length(seq_num_RLE_2);
% seq_num_RLE_2_re = '';
% %1==A  2==G  3==C  4==T
% for seq_num_RLE_2_L_i = 1:seq_num_RLE_2_L
%     if seq_num_RLE_2(seq_num_RLE_2_L_i) == '1'
%         seq_num_RLE_2_re = strcat(seq_num_RLE_2_re,'A');
%     elseif seq_num_RLE_2(seq_num_RLE_2_L_i) == '2'
%         seq_num_RLE_2_re = strcat(seq_num_RLE_2_re,'G');
%     elseif seq_num_RLE_2(seq_num_RLE_2_L_i) == '3'
%         seq_num_RLE_2_re = strcat(seq_num_RLE_2_re,'C');
%     elseif seq_num_RLE_2(seq_num_RLE_2_L_i) == '4'
%         seq_num_RLE_2_re = strcat(seq_num_RLE_2_re,'T');
%     else
%         fprintf("超限！")
%     end
% end
% %转二进制流
% seq_num_RLE_2_re_L = length(seq_num_RLE_2_re);
% seq_num_RLE_2_re_2 = '';
% for seq_num_RLE_2_re_2_I = 1: seq_num_RLE_2_re_L
%     if seq_num_RLE_2_re(seq_num_RLE_2_re_2_I) == 'A'
%         seq_num_RLE_2_re_2 = strcat(seq_num_RLE_2_re_2,'00');
%     elseif seq_num_RLE_2_re(seq_num_RLE_2_re_2_I) == 'T'
%         seq_num_RLE_2_re_2 = strcat(seq_num_RLE_2_re_2,'01');
%     elseif seq_num_RLE_2_re(seq_num_RLE_2_re_2_I) == 'C'
%         seq_num_RLE_2_re_2 = strcat(seq_num_RLE_2_re_2,'10');
%     elseif seq_num_RLE_2_re(seq_num_RLE_2_re_2_I) == 'G'
%         seq_num_RLE_2_re_2 = strcat(seq_num_RLE_2_re_2,'11');
%     end   
% end

%RLE_2   gzip（输出为16进制）--二进制--轮转
% RLE_2_Gzip = '1F8B080000000000000375580962E430087B13B8FF7F5B1B1B5D4E3ABB9DC96163104226A9D55D555DCFEFFCED2BE7607F78F87770C63EDFFB42AFE6BCF3F31C742F9B85C95AE54C3B16B7B1593566E80CAB5D46F655CC9C3133493FB8DEEBB6BBEFF0EBEF5FF1E23A87CFAC3D3A6F868783C0DC29A039AB9EC8AA7E9EA3C7DE1D23C29905C64B9888C1C4A8960EBB91897F72D7C8D3C90CFEBF3273825EC0EA2B2107E79E980C687C051B7A636AD198878B9E667863686294B3F4689B29210E038F5F91790081BCC9643349E0F20A1B46BB93FD605692726C2C85754E0E1DC75991B04FA21197F165BEFE12602179546756FD106DA4A1AFB8AD3679C5A01E8359ED57A67D8C1CCFC23AC5E163E4F8C44E5130D8BD109FAA582C1C268AECA59C7C6473D7CBA7EF8065C53D4E6ECB16E2C0E7CC3AA56818A03889EF9074F33B0AD4B2BC89300285C3129D8C7553267FE78BF0BC6AFF521D151AD368BAD060811064853E0CFAB63CCAFD2E6DFB8D020144558EF68458A667C6195FD352D3417AB32A8D0FB6C61E223F3A2E8C8CF7E02A6F9730A3A8F4325402D8BE8F87F892120F1E42AB3CCCF98ED17CC4D96C80990FEA6004390B8C5CD84EE8712BD3542D032877664B12DDF0E210C82EB4A8A3E0B1813A051C014B937C6D571F53F66E0BA9116F426A302668324B2E7100F6604D0CE4BBFB32ACA83C6DDDB3310469CC0FEB46F66044B28B5CB70CABD4C7A0D663EC872782C6762F6BA11879DF92A015C8C85E1EE240E7501A1968B11DD6DB74346117A4AE28D2E3D66A91328CD98E7599A18F88D8939A5CA98AA8460B420375B156C2C0A149E35254E8E6A455C2BA7615E6403BC945346F286DDA4B9999F7EC6E7BDDF692895642526B51C4F4EDE2FFFBA3AAEA1555C3360DFE4CC45930BE0568BC472BD5B969E30A2766D47A0D647B4452C556A8AAECE6C045DF68A4CD5505ABFB594E1E6710C9E16196AD50232D1E51B03F6ABD56A822A261810AA832CA99A87CD6EC0C74254E0DB57EBED503910CB6AFE9C9E2B6544EF47C4C8318EFD0426391B370CFB5CF601F57C4224CB23C398CBE35528BC883ABC189F67A56B2A702279919F8A790E9F0B4F9C925CC6FB7101C54CB80BF09F86A767574E971B08A0A675BB495D86C96123AE3BAB5B643F58EDD9C089593C6B0B49CC9310E7745B860709DD0FEC54D5DF633CDE8EDB9D63A8F52B93C1DB5942F3F72DD603963B27E23702E11D2E4AB64A4D793AE0A87E8BEDB2A7969E8455E85A8F6ACAF99970E2940D5BA049539C031C9997C8902102277CF9F15D5110448F3DFC7CA8BD651CBD74EF03263001116B5C9D2D4E8D6B3DD38AD6EB7655D9ACCFEDAF0881725919AE890EF2D280F5E61604BF616D22654145D541F94F17E94EA61249B709718D3495BCFB420AAC7D37B7C2591CF51572DF7158EBCA51225BDB2AA2DD2BB0F65F6B26507E422B877040983ED129E8B78AB144B4E544028FC17A8CA335E1F655FCC662F1B00FF00BA4BEC5F1254E5A9B863CCADE6C70B8E5DDE2BBEEFD7335F14CDC775BD1279412A4F63BABD0B04292C7D1E43FD7BDF483AD036FB87104C69B41AF57CF07194EBF5BA5B958DBDE719C3B7C9755E3743188C849687825B7773F4B1AB4B7A1DBF085FB97A29F13B01CCD37BEBA41350DC56666EC669A972801059AB82E78C6F4FAF05034CD3DD8FD736350F6326E651C9AFBAB6AD899A0D9F2CAA9A3E030A2BB24B39E5B64B232FD507E7D1EF8143B8F90BA9F9838A97190000';
% RLE_2_Gzip_L = length(RLE_2_Gzip);
% RLE_2_Gzip_2 = '';
% for RLE_2_Gzip_i = 1:RLE_2_Gzip_L
%     RLE_2_Gzip_2 = strcat(RLE_2_Gzip_2,dec2bin(hex2dec(RLE_2_Gzip(RLE_2_Gzip_i))));
% end

% [goldman_sequence_RLE_2, goldman_sequence_number_RLE_2] = goldman(RLE_2_Gzip_2)

%序列重排后总碱基数
% o = goldman_sequence_number_JX +  goldman_sequence_number_RLE_2


